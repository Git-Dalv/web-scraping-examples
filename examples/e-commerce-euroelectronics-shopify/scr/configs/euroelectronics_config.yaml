# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Async HTTP Client Configuration
# For scraping: euroelectronics.eu (Shopify)
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

http_client:
  base_url: "https://euroelectronics.eu"

  # ─────────────────────────────────────────
  # Rate Limiting (IMPORTANT to avoid 429!)
  # ─────────────────────────────────────────
  rate_limit:
    enabled: true
    requests_per_second: 0.5      # Max 0.5 request per second
    requests_per_minute: 20      # Max 20 requests per minute
    burst: 1                     # Allow 1 burst request
    delay_between_requests: 3.0  # Minimum 3 sec between requests
    delay_jitter: 3.0            # +/- 3 sec random delay


  # ─────────────────────────────────────────
  # Timeouts
  # ─────────────────────────────────────────
  timeout:
    connect: 10          # Connection timeout (sec)
    read: 30             # Read timeout
    total: 60            # Total request timeout

  # ─────────────────────────────────────────
  # Retry Strategy (for 429 and other errors)
  # ─────────────────────────────────────────
  retry:
    max_attempts: 5
    backoff_base: 5.0            # Initial backoff delay
    backoff_factor: 5.0          # Exponential multiplier
    backoff_max: 60.0            # Maximum backoff delay
    backoff_jitter: true         # Add random jitter
    respect_retry_after: true    # Honor Retry-After header
    retry_after_max: 120         # Max wait time from Retry-After
    retry_on_status: [429, 500, 502, 503, 504]  # Status codes to retry

  # ─────────────────────────────────────────
  # Connection Pool (10-15 parallel)
  # ─────────────────────────────────────────
  pool:
    connections: 10           # Keepalive connections
    maxsize: 15               # Maximum concurrent connections
    max_redirects: 5          # Shopify sometimes redirects

  # ─────────────────────────────────────────
  # Security
  # ─────────────────────────────────────────
  security:
    verify_ssl: true
    allow_redirects: true
    max_response_size: 10485760   # 10MB (HTML pages are lightweight)

  # ─────────────────────────────────────────
  # Circuit Breaker
  # ─────────────────────────────────────────
  circuit_breaker:
    enabled: true
    failure_threshold: 10      # Pause after 5 failures
    recovery_timeout: 30.0    # 30 sec before retry attempt
    half_open_max_calls: 2    # Test requests in half-open state

  # ─────────────────────────────────────────
  # Headers (browser simulation)
  # ─────────────────────────────────────────
headers:
  default:
    Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8"
    Accept-Language: "en-US,en;q=0.9,ru;q=0.8"
    Accept-Encoding: "gzip, deflate, br"
    DNT: "1"
    Connection: "keep-alive"
    Upgrade-Insecure-Requests: "1"
    Sec-Fetch-Dest: "document"
    Sec-Fetch-Mode: "navigate"
    Sec-Fetch-Site: "none"
    Cache-Control: "max-age=0"

  # ============================================
  # User-Agent Rotation - ENABLED
  # ============================================
  user_agent_rotation:
    enabled: true              # Enable rotation
    strategy: "random"         # random or sequential

  # User-Agent list for rotation
  user_agents:
    - "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
    - "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36"
    - "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0"
    - "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0"
    - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
    - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Safari/605.1.15"
    - "Mozilla/5.0 (X11; Linux x86_64; rv:121.0) Gecko/20100101 Firefox/121.0"
    - "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:120.0) Gecko/20100101 Firefox/120.0"

  # ─────────────────────────────────────────
  # Logging
  # ─────────────────────────────────────────
  logging:
    level: "WARNING"
    format: "text"
    enable_console: false
    log_request_body: false
    log_response_body: false
    log_file: null